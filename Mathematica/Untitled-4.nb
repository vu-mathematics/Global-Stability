(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13221,        420]
NotebookOptionsPosition[     12703,        403]
NotebookOutlinePosition[     13040,        418]
CellTagsIndexPosition[     12997,        415]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"F1", "=", 
   RowBox[{
    RowBox[{"e1", " ", 
     RowBox[{"f1", "[", 
      RowBox[{"x1", "[", 
       RowBox[{"e1", ",", "e2"}], "]"}], "]"}]}], "-", 
    RowBox[{"c", "[", 
     RowBox[{"e1", ",", "e2"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F2", "=", 
   RowBox[{
    RowBox[{"e2", " ", 
     RowBox[{"f2", "[", 
      RowBox[{
       RowBox[{"x1", "[", 
        RowBox[{"e1", ",", "e2"}], "]"}], ",", 
       RowBox[{"x2", "[", 
        RowBox[{"e1", ",", "e2"}], "]"}]}], "]"}]}], "-", 
    RowBox[{"c", "[", 
     RowBox[{"e1", ",", "e2"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "e1", "-", "e2"}], ")"}], " ", 
     RowBox[{"f3", "[", 
      RowBox[{"x2", "[", 
       RowBox[{"e1", ",", "e2"}], "]"}], "]"}]}], "-", 
    RowBox[{"c", "[", 
     RowBox[{"e1", ",", "e2"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"F1", ",", "e1"}], "]"}], "\[Equal]", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"F1", ",", "e2"}], "]"}], "\[Equal]", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"F2", ",", "e1"}], "]"}], "\[Equal]", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"F2", ",", "e2"}], "]"}], "\[Equal]", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"F3", ",", "e1"}], "]"}], "\[Equal]", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"F3", ",", "e2"}], "]"}], "\[Equal]", "0"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rulesNis3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f1", "[", 
       RowBox[{"x1", "[", 
        RowBox[{"e1", ",", "e2"}], "]"}], "]"}], "\[Rule]", 
      SubscriptBox["f", "1"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f2", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"e1", ",", "e2"}], "]"}], ",", 
        RowBox[{"x2", "[", 
         RowBox[{"e1", ",", "e2"}], "]"}]}], "]"}], "\[Rule]", 
      SubscriptBox["f", "2"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f3", "[", 
       RowBox[{"x2", "[", 
        RowBox[{"e1", ",", "e2"}], "]"}], "]"}], "\[Rule]", 
      SubscriptBox["f", "3"]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x1", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"e1", ",", "e2"}], "]"}], "\[Rule]", "dx1de1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x1", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"e1", ",", "e2"}], "]"}], "\[Rule]", "dx1de2"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x2", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"e1", ",", "e2"}], "]"}], "\[Rule]", "dx2de1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x2", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"e1", ",", "e2"}], "]"}], "\[Rule]", "dx2de2"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["c", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"e1", ",", "e2"}], "]"}], "\[Rule]", "dcde1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["c", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"e1", ",", "e2"}], "]"}], "\[Rule]", "dcde2"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["f1", "\[Prime]",
        MultilineFunction->None], "[", 
       RowBox[{"x1", "[", 
        RowBox[{"e1", ",", "e2"}], "]"}], "]"}], "\[Rule]", 
      RowBox[{"-", 
       SubscriptBox["f", 
        RowBox[{"1", ",", "2"}]]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["f2", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"e1", ",", "e2"}], "]"}], ",", 
        RowBox[{"x2", "[", 
         RowBox[{"e1", ",", "e2"}], "]"}]}], "]"}], "\[Rule]", 
      SubscriptBox["f", 
       RowBox[{"2", ",", "1"}]]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["f2", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"e1", ",", "e2"}], "]"}], ",", 
        RowBox[{"x2", "[", 
         RowBox[{"e1", ",", "e2"}], "]"}]}], "]"}], "\[Rule]", 
      RowBox[{"-", 
       SubscriptBox["f", 
        RowBox[{"2", ",", "2"}]]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["f3", "\[Prime]",
        MultilineFunction->None], "[", 
       RowBox[{"x2", "[", 
        RowBox[{"e1", ",", "e2"}], "]"}], "]"}], "\[Rule]", 
      SubscriptBox["f", 
       RowBox[{"3", ",", "1"}]]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"eqs", "=", 
  RowBox[{"eqs", "/.", "rulesNis3"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"{", 
    RowBox[{
    "dx1de1", ",", "dx1de2", ",", "dx2de1", ",", "dx2de2", ",", "dcde1", ",", 
     "dcde2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coefs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"First", "[", 
        RowBox[{"List", " ", "@@", " ", 
         RowBox[{"eqs", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "vars"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"First", "[", 
        RowBox[{"List", " ", "@@", " ", 
         RowBox[{"eqs", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "vars"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"First", "[", 
        RowBox[{"List", " ", "@@", " ", 
         RowBox[{"eqs", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", "vars"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"First", "[", 
        RowBox[{"List", " ", "@@", " ", 
         RowBox[{"eqs", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ",", "vars"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"First", "[", 
        RowBox[{"List", " ", "@@", " ", 
         RowBox[{"eqs", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "]"}], ",", "vars"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"First", "[", 
        RowBox[{"List", " ", "@@", " ", 
         RowBox[{"eqs", "[", 
          RowBox[{"[", "6", "]"}], "]"}]}], "]"}], ",", "vars"}], "]"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"coefs", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8030309473810453`*^9, 3.803031143942174*^9}},
 CellLabel->
  "In[2270]:=",ExpressionUUID->"0e354b50-f3e5-440a-9098-29c54d49f6e1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "dcde1"}], "+", 
     SubscriptBox["f", "1"], "-", 
     RowBox[{"dx1de1", " ", "e1", " ", 
      SubscriptBox["f", 
       RowBox[{"1", ",", "2"}]]}]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "dcde2"}], "-", 
     RowBox[{"dx1de2", " ", "e1", " ", 
      SubscriptBox["f", 
       RowBox[{"1", ",", "2"}]]}]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "dcde1"}], "+", 
     RowBox[{"e2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dx1de1", " ", 
         SubscriptBox["f", 
          RowBox[{"2", ",", "1"}]]}], "-", 
        RowBox[{"dx2de1", " ", 
         SubscriptBox["f", 
          RowBox[{"2", ",", "2"}]]}]}], ")"}]}]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "dcde2"}], "+", 
     SubscriptBox["f", "2"], "+", 
     RowBox[{"e2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dx1de2", " ", 
         SubscriptBox["f", 
          RowBox[{"2", ",", "1"}]]}], "-", 
        RowBox[{"dx2de2", " ", 
         SubscriptBox["f", 
          RowBox[{"2", ",", "2"}]]}]}], ")"}]}]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "dcde1"}], "-", 
     SubscriptBox["f", "3"], "+", 
     RowBox[{"dx2de1", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "e1", "-", "e2"}], ")"}], " ", 
      SubscriptBox["f", 
       RowBox[{"3", ",", "1"}]]}]}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "dcde2"}], "-", 
     SubscriptBox["f", "3"], "+", 
     RowBox[{"dx2de2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "e1", "-", "e2"}], ")"}], " ", 
      SubscriptBox["f", 
       RowBox[{"3", ",", "1"}]]}]}], "\[Equal]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.80303100481961*^9, {3.8030310706763887`*^9, 3.803031079293022*^9}, {
   3.803031111603756*^9, 3.803031144954837*^9}},
 CellLabel->
  "Out[2275]=",ExpressionUUID->"af0e7948-23b4-439d-8759-1086cdfeb8f6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "e1"}], " ", 
       SubscriptBox["f", 
        RowBox[{"1", ",", "2"}]]}], "0", "0", "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", "e1"}], " ", 
       SubscriptBox["f", 
        RowBox[{"1", ",", "2"}]]}], "0", "0", "0", 
      RowBox[{"-", "1"}]},
     {
      RowBox[{"e2", " ", 
       SubscriptBox["f", 
        RowBox[{"2", ",", "1"}]]}], "0", 
      RowBox[{
       RowBox[{"-", "e2"}], " ", 
       SubscriptBox["f", 
        RowBox[{"2", ",", "2"}]]}], "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", 
      RowBox[{"e2", " ", 
       SubscriptBox["f", 
        RowBox[{"2", ",", "1"}]]}], "0", 
      RowBox[{
       RowBox[{"-", "e2"}], " ", 
       SubscriptBox["f", 
        RowBox[{"2", ",", "2"}]]}], "0", 
      RowBox[{"-", "1"}]},
     {"0", "0", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "e1", "-", "e2"}], ")"}], " ", 
       SubscriptBox["f", 
        RowBox[{"3", ",", "1"}]]}], "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", "0", "0", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "e1", "-", "e2"}], ")"}], " ", 
       SubscriptBox["f", 
        RowBox[{"3", ",", "1"}]]}], "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.80303100481961*^9, {3.8030310706763887`*^9, 3.803031079293022*^9}, {
   3.803031111603756*^9, 3.803031144958248*^9}},
 CellLabel->
  "Out[2278]//MatrixForm=",ExpressionUUID->"a8dd57ed-f8d4-4885-8d67-\
ad9436ef5d0d"]
}, Open  ]]
},
WindowSize->{808, 905},
WindowMargins->{{100, Automatic}, {Automatic, 4}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 8138, 248, 713, "Input",ExpressionUUID->"0e354b50-f3e5-440a-9098-29c54d49f6e1"],
Cell[8721, 272, 2021, 63, 83, "Output",ExpressionUUID->"af0e7948-23b4-439d-8759-1086cdfeb8f6"],
Cell[10745, 337, 1942, 63, 206, "Output",ExpressionUUID->"a8dd57ed-f8d4-4885-8d67-ad9436ef5d0d"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

